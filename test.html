<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selenium REPL Cheatsheet</title>
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css" rel="stylesheet" />
    <style>
        .main {
            width:fit-content
        }
        h1, h2 {
            font-family: "Trebuchet MS", sans-serif;
            letter-spacing: -2px;
        }
        h1 {
            font-size: 3rem;
        }        
        h2 {
            font-size: 2rem;
            text-transform: uppercase;
            border-bottom: 2px solid black;
        }
        #toc-container {
            background: #f9f9f9 none repeat scroll 0 0;
            border: 1px solid #aaa;
            display: table;
            padding: 20px;
        }
        .toc-title {
            font-weight: 700;
            font-size: 1.5rem;
            font-family: sans-serif;
        }
        #toc-container ul {
            padding-inline-start: inherit;
        }
        #toc-container li {
            list-style: auto;
        }
        a {
            color: black;
            font-size: 1.15rem;
        }
    </style>
</head>
<body class="language-javascript">
    <h1>Selenium REPL Cheatsheet</h1>
    <div id="toc-container">
        <div class="toc-title">Contents</div>
        <ul>
            <li><a href="#general-example">General example</a></li>
            <li><a href="#installing-browser-drivers">Installing browser drivers</a></li>
            <li><a href="#browser-manipulation">Browser manipulation</a></li>
            <li><a href="#locating-elements">Locating elements</a></li>
            <li><a href="#waits">Waits</a></li>
            <li><a href="#js-alerts-prompts-and-confirmations">JS alerts, prompts, and confirmations</a></li>
            <li><a href="#http-proxies">HTTP proxies</a></li>
            <li><a href="#page-loading-strategy">Page loading strategy</a></li>
            <li><a href="#web-element">Web Element</a></li>
            <li><a href="#keyboard">Keyboard</a></li>
            <li><a href="#remote-webdriver">Remote Webdriver</a></li>
            <li><a href="#bidi-apis">BiDi APIs</a></li>
            <li><a href="#driver-specific-capabilities">Driver specific capabilities</a></li>
            <li><a href="#on-test-automation">On test automation</a></li>
            <li><a href="#mouse-and-keyboard-actions-in-detail">Mouse and keyboard actions in detail</a></li>
            <li><a href="#working-with-cookies">Working with cookies</a></li>
            <li><a href="#chrome-devtools">Chrome devtools</a></li>
        </ul>
    </div>
    <div class="main">
        <div>
            <h2 id="general-example">General example</h2>
            <a href="https://www.selenium.dev/documentation/">source</a>
<pre><code>const {Builder, By, Key, until} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('firefox').build();
try {
    // Navigate to Url
    await driver.get('https://www.google.com');

    // Enter text "cheese" and perform keyboard action "Enter"
    await driver.findElement(By.name('q')).sendKeys('cheese', Key.ENTER);

    let firstResult = await driver.wait(until.elementLocated(By.css('h3')), 10000);

    console.log(await firstResult.getAttribute('textContent'));
}
finally {
    await driver.quit();
}</code></pre>
        </div>
        <div>
            <h2 id="installing-browser-drivers">Installing browser drivers</h2>
            <a href="https://www.selenium.dev/documentation/getting_started/installing_browser_drivers/">source</a>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('chrome').build();</code></pre>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('firefox').build();
</code></pre>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('MicrosoftEdge').build();</code></pre>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('internet explorer').build();</code></pre>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('opera').build();</code></pre>
<pre><code>const {Builder} = require('selenium-webdriver');
let driver = await new Builder().forBrowser('safari').build();</code></pre>
        </div>
        <div>
            <h2 id="browser-manipulation">Browser manipulation</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/browser_manipulation/">source</a>
<pre><code>await driver.get('https://selenium.dev');</code></pre>
<pre><code>await driver.getCurrentUrl();</code></pre>
<pre><code>await driver.navigate().back();</code></pre>
<pre><code>await driver.navigate().forward();</code></pre>
<pre><code>await driver.navigate().refresh();</code></pre>
<pre><code>await driver.getTitle();</code></pre>
<pre><code>await driver.getWindowHandle();</code></pre>
<pre><code>// Wait for the new window or tab
await driver.wait(
    async () => (await driver.getAllWindowHandles()).length === 2,
    10000
);</code></pre>
<pre><code>// Loop through until we find a new window handle
const windows = await driver.getAllWindowHandles();
windows.forEach(async handle => {
  if (handle !== originalWindow) {
    await driver.switchTo().window(handle);
  }
});</code></pre>
<pre><code>// Wait for the new tab to finish loading content
await driver.wait(until.titleIs('Selenium documentation'), 10000);</code></pre>
<pre><code>// Opens a new tab and switches to new tab
await driver.switchTo().newWindow('tab');</code></pre>
<pre><code>// Opens a new window and switches to new window
await driver.switchTo().newWindow('window');</code></pre>
<pre><code>// Close the tab or window
await driver.close();</code></pre>
<pre><code>// Switch back to the old tab or window
await driver.switchTo().window(originalWindow);</code></pre>
<pre><code>// Store the web element
const iframe = driver.findElement(By.css('#modal > iframe'));
// Switch to the frame
await driver.switchTo().frame(iframe);</code></pre>
<pre><code>// Using the ID
await driver.switchTo().frame('buttonframe');</code></pre>
<pre><code>// Or using the name instead
await driver.switchTo().frame('myframe');</code></pre>
<pre><code>// Switches to the second frame
await driver.switchTo().frame(1);</code></pre>
<pre><code>// Return to the top level
await driver.switchTo().defaultContent();</code></pre>
<pre><code>const { width, height } = await driver.manage().window().getRect();</code></pre>
<pre><code>await driver.manage().window().setRect({ width: 1024, height: 768 });</code></pre>
<pre><code>const { x, y } = await driver.manage().window().getRect();</code></pre>
<pre><code>// Move the window to the top left of the primary monitor
await driver.manage().window().setRect({ x: 0, y: 0 });</code></pre>
<pre><code>await driver.manage().window().maximize();</code></pre>
<pre><code>await driver.manage().window().minimize();</code></pre>
<pre><code>await driver.manage().window().fullscreen();</code></pre>
<pre><code>// Returns base64 encoded string
let encodedString = await driver.takeScreenshot();
await fs.writeFileSync('./image.png', encodedString, 'base64');</code></pre>
<pre><code>// Captures the element screenshot
let encodedString = await element.takeScreenshot(true);
await fs.writeFileSync('./image.png', encodedString, 'base64');</code></pre>
<pre><code>// Executing JavaScript to capture innerText of header element
let text = await driver.executeScript('return arguments[0].innerText', header);</code></pre>
<pre><code>// Print page as PDF
try {
    let base64 = await driver.printPage({pageRanges:["1-2"]});
    await fs.writeFileSync('./test.pdf', base64, 'base64');
} catch (e) {
    console.log(e)
}</code></pre>
        </div>
        <div>
            <h2 id="locating-elements">Locating elements</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/locating_elements/">source</a>
        </div>
        <div>
            <h2 id="waits">Waits</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/waits/">source</a>
        </div>
        <div>
            <h2 id="js-alerts-prompts-and-confirmations">JS alerts, prompts, and confirmations</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/js_alerts_prompts_and_confirmations/">source</a>            
        </div>
        <div>
            <h2 id="http-proxies">HTTP proxies</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/http_proxies/">source</a>            
        </div>
        <div>
            <h2 id="page-loading-strategy">Page loading strategy</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/page_loading_strategy/">source</a>            
        </div>
        <div>
            <h2 id="web-element">Web Element</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/web_element/">source</a>            
        </div>
        <div>
            <h2 id="keyboard">Keyboard</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/keyboard/">source</a>            
        </div>
        <div>
            <h2 id="remote-webdriver">Remote Webdriver</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/remote_webdriver/">source</a>
        </div>
        <div>
            <h2 id="bidi-apis">BiDi APIs</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/bidi_apis/">source</a>
        </div>
        <div>
            <h2 id="driver-specific-capabilities">Driver specific capabilities</h2>
            <a href="https://www.selenium.dev/documentation/webdriver/capabilities/driver_specific_capabilities/">source</a>
        </div>
        <div>
            <h2 id="on-test-automation">On test automation</h2>
            <a href="https://www.selenium.dev/documentation/guidelines/on_test_automation/">source</a>
        </div>
        <div>
            <h2 id="mouse-and-keyboard-actions-in-detail">Mouse and keyboard actions in detail</h2>
            <a href="https://www.selenium.dev/documentation/support_packages/mouse_and_keyboard_actions_in_detail/">source</a>            
        </div>
        <div>
            <h2 id="working-with-cookies">Working with cookies</h2>
            <a href="https://www.selenium.dev/documentation/support_packages/working_with_cookies/">source</a>            
        </div>
        <div>
            <h2 id="chrome-devtools">Chrome devtools</h2>
            <a href="https://www.selenium.dev/documentation/support_packages/chrome_devtools/">source</a>            
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/components/prism-core.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
